// ==UserScript==
// @name        bilibili屏蔽
// @version     1.0
// @author      zzxt0019
// @match       *://www.bilibili.com/*
// @match       *://search.bilibili.com/*
// @match       *://live.bilibili.com/*
// @match       *://space.bilibili.com/*
// @match       *://t.bilibili.com/*
// @match       *://h.bilibili.com/*
// @match       *://manga.bilibili.com/*
// @match       *://message.bilibili.com/*
// @noframes
// @description bilibili屏蔽
// @grant       GM_setValue
// @grant       GM_getValue
// @grant       GM_deleteValue
// @grant       GM_registerMenuCommand
// ==/UserScript==
(()=>{var L={640:()=>{var g=function(v,h,_){"use strict";if(!v.MutationObserver||typeof HTMLElement=="undefined")return;var y=0,c=function(){var o=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(t,e){return t instanceof HTMLElement&&o.call(t,e)},addMethod:function(t,e,r){var n=t[e];t[e]=function(){if(r.length==arguments.length)return r.apply(this,arguments);if(typeof n=="function")return n.apply(this,arguments)}},callCallbacks:function(t,e){e&&e.options.onceOnly&&e.firedElems.length==1&&(t=[t[0]]);for(var r=0,n;n=t[r];r++)n&&n.callback&&n.callback.call(n.elem,n.elem);e&&e.options.onceOnly&&e.firedElems.length==1&&e.me.unbindEventWithSelectorAndCallback.call(e.target,e.selector,e.callback)},checkChildNodesRecursively:function(t,e,r,n){for(var u=0,i;i=t[u];u++)r(i,e,n)&&n.push({callback:e.callback,elem:i}),i.childNodes.length>0&&c.checkChildNodesRecursively(i.childNodes,e,r,n)},mergeArrays:function(t,e){var r={},n;for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r},toElementsArray:function(t){return typeof t!="undefined"&&(typeof t.length!="number"||t===v)&&(t=[t]),t}}}(),S=function(){var o=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return o.prototype.addEvent=function(t,e,r,n){var u={target:t,selector:e,options:r,callback:n,firedElems:[]};return this._beforeAdding&&this._beforeAdding(u),this._eventsBucket.push(u),u},o.prototype.removeEvent=function(t){for(var e=this._eventsBucket.length-1,r;r=this._eventsBucket[e];e--)if(t(r)){this._beforeRemoving&&this._beforeRemoving(r);var n=this._eventsBucket.splice(e,1);n&&n.length&&(n[0].callback=null)}},o.prototype.beforeAdding=function(t){this._beforeAdding=t},o.prototype.beforeRemoving=function(t){this._beforeRemoving=t},o}(),E=function(o,t){var e=new S,r=this,n={fireOnAttributesModification:!1};return e.beforeAdding(function(u){var i=u.target,l;(i===v.document||i===v)&&(i=document.getElementsByTagName("html")[0]),l=new MutationObserver(function(s){t.call(this,s,u)});var a=o(u.options);l.observe(i,a),u.observer=l,u.me=r}),e.beforeRemoving(function(u){u.observer.disconnect()}),this.bindEvent=function(u,i,l){i=c.mergeArrays(n,i);for(var a=c.toElementsArray(this),s=0;s<a.length;s++)e.addEvent(a[s],u,i,l)},this.unbindEvent=function(){var u=c.toElementsArray(this);e.removeEvent(function(i){for(var l=0;l<u.length;l++)if(this===_||i.target===u[l])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(u){var i=c.toElementsArray(this),l=u,a;typeof u=="function"?a=function(s){for(var f=0;f<i.length;f++)if((this===_||s.target===i[f])&&s.callback===l)return!0;return!1}:a=function(s){for(var f=0;f<i.length;f++)if((this===_||s.target===i[f])&&s.selector===u)return!0;return!1},e.removeEvent(a)},this.unbindEventWithSelectorAndCallback=function(u,i){var l=c.toElementsArray(this);e.removeEvent(function(a){for(var s=0;s<l.length;s++)if((this===_||a.target===l[s])&&a.selector===u&&a.callback===i)return!0;return!1})},this},w=function(){var o={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function t(u){var i={attributes:!1,childList:!0,subtree:!0};return u.fireOnAttributesModification&&(i.attributes=!0),i}function e(u,i){u.forEach(function(l){var a=l.addedNodes,s=l.target,f=[],A;a!==null&&a.length>0?c.checkChildNodesRecursively(a,i,r,f):l.type==="attributes"&&r(s,i,f)&&f.push({callback:i.callback,elem:s}),c.callCallbacks(f,i)})}function r(u,i,l){return c.matchesSelector(u,i.selector)&&(u._id===_&&(u._id=y++),i.firedElems.indexOf(u._id)==-1)?(i.firedElems.push(u._id),!0):!1}d=new E(t,e);var n=d.bindEvent;return d.bindEvent=function(u,i,l){typeof l=="undefined"?(l=i,i=o):i=c.mergeArrays(o,i);var a=c.toElementsArray(this);if(i.existing){for(var s=[],f=0;f<a.length;f++)for(var A=a[f].querySelectorAll(u),k=0;k<A.length;k++)s.push({callback:l,elem:A[k]});if(i.onceOnly&&s.length)return l.call(s[0].elem,s[0].elem);setTimeout(c.callCallbacks,1,s)}n.call(this,u,i,l)},d},V=function(){var o={};function t(){var u={childList:!0,subtree:!0};return u}function e(u,i){u.forEach(function(l){var a=l.removedNodes,s=[];a!==null&&a.length>0&&c.checkChildNodesRecursively(a,i,r,s),c.callCallbacks(s,i)})}function r(u,i){return c.matchesSelector(u,i.selector)}m=new E(t,e);var n=m.bindEvent;return m.bindEvent=function(u,i,l){typeof l=="undefined"?(l=i,i=o):i=c.mergeArrays(o,i),n.call(this,u,i,l)},m},d=new w,m=new V;function b(o,t,e){c.addMethod(t,e,o.unbindEvent),c.addMethod(t,e,o.unbindEventWithSelectorOrCallback),c.addMethod(t,e,o.unbindEventWithSelectorAndCallback)}function p(o){o.arrive=d.bindEvent,b(d,o,"unbindArrive"),o.leave=m.bindEvent,b(m,o,"unbindLeave")}h&&p(h.fn),p(HTMLElement.prototype),p(NodeList.prototype),p(HTMLCollection.prototype),p(HTMLDocument.prototype),p(Window.prototype);var M={};return b(d,M,"unbindAllArrive"),b(m,M,"unbindAllLeave"),M}(window,typeof jQuery=="undefined"?null:jQuery,void 0)}},C={};function G(g){var v=C[g];if(v!==void 0)return v.exports;var h=C[g]={exports:{}};return L[g](h,h.exports,G),h.exports}var N={};(()=>{"use strict";var g=G(640);let v=["\u4E43\u7433","\u5411\u665A","\u8D1D\u62C9","\u73C8\u4E50","\u5609\u7136"],h=[730732],_=null;function y(){GM_getValue("cards")||GM_setValue("cards",v),GM_registerMenuCommand("\u6DFB\u52A0\u5361\u7247",()=>{let e=prompt(`card:
            ${GM_getValue("cards",[]).join(",")}`);if(e){let r=GM_getValue("cards");r.push(...e.split(" ")),GM_setValue("cards",r)}}),GM_registerMenuCommand("\u5220\u9664\u5361\u7247",()=>{let e=prompt(`card:
            ${GM_getValue("cards",[]).join(",")}`);if(e){let r=new Set(e.split(" "));GM_setValue("cards",GM_getValue("cards").filter(n=>!r.has(n)))}}),GM_registerMenuCommand("\u5C55\u793A\u5361\u7247",()=>{alert(`card:
            ${GM_getValue("cards",[]).join(",")}`)})}function c(t){if(t){for(const e of _cards)if(t.includes(e))return!0}return!1}function S(t){return t?GM_getValue("uids",[]).includes(t):!1}function E(t){return t?GM_getValue("uids",[]).map(d).includes(t):!1}function w(...t){console.log("userscript",...t)}class V{constructor(e,r,n){this.uid=e,this.username=r,this.expiretime=n}}function d(t){let r=GM_getValue("uid_"+t);if(r&&new Date().getTime()<r.expiretime)return r.username;{let n=new XMLHttpRequest;n.open("GET","https://api.bilibili.com/x/space/acc/info?mid="+t,!1),n.send(null);let u=JSON.parse(n.responseText).data.name;return r={uid:t,username:u,expiretime:new Date().getTime()+Math.random()*24*60*60*1e3},GM_setValue("uid_"+t,r),r.username}}function m(){GM_getValue("uids")||GM_setValue("uids",h),GM_registerMenuCommand("\u6DFB\u52A0up",()=>{let e=GM_getValue("uids",[]).map(n=>`${n}(${d(n)})`).join(","),r=prompt(`uid:
            ${e}`);if(r){let n=GM_getValue("uids");n.push(...r.split(" ").map(Number)),GM_setValue("uids",n)}}),GM_registerMenuCommand("\u5220\u9664up",()=>{let e=GM_getValue("uids",[]).map(n=>`${n}(${d(n)})`).join(","),r=prompt(`uid:
            ${e}`);if(r){let n=new Set(r.split(" ").map(Number));GM_setValue("uids",GM_getValue("uids").filter(u=>!n.has(u)))}}),GM_registerMenuCommand("\u5C55\u793Aup",()=>{let e=GM_getValue("uids",[]).map(r=>`${r}(${d(r)})`).join(",");alert(`uid:
            ${e}`)})}class b extends p{constructor(){super(...arguments),this.mainSelector=".rank-wrap",this.innerSelector=".info .name"}bingo(e){return E(e.innerHTML)}}class p{bingo(e){return!1}ifRemove(e){if(this.innerSelector===void 0){if(this.bingo(e))return!0}else{let r=e.querySelectorAll(this.innerSelector);for(let n=0;n<r.length;n++){const u=r[n];if(this.bingo(u))return!0}}return!1}}let M=[new b];o();function o(){y(),m();let t=[];for(const e of h)t.push(d(e));for(const e of M)document.arrive(e.mainSelector,{fireOnAttributesModification:!0,onceOnly:!1,existing:!0},r=>{e.ifRemove(r)&&r.remove()})}})()})();
