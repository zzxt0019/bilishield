// ==UserScript==
// @name        bilibili屏蔽
// @version     1.0
// @author      zzxt0019
// @match       *://www.bilibili.com/*
// @match       *://search.bilibili.com/*
// @match       *://live.bilibili.com/*
// @match       *://space.bilibili.com/*
// @match       *://t.bilibili.com/*
// @match       *://h.bilibili.com/*
// @match       *://manga.bilibili.com/*
// @match       *://message.bilibili.com/*
// @noframes
// @description bilibili屏蔽
// @grant       GM_setValue
// @grant       GM_getValue
// @grant       GM_deleteValue
// @grant       GM_registerMenuCommand
// ==/UserScript==
(()=>{var L={640:()=>{var A=function(p,g,b){"use strict";if(!p.MutationObserver||typeof HTMLElement=="undefined")return;var S=0,m=function(){var f=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(u,i){return u instanceof HTMLElement&&f.call(u,i)},addMethod:function(u,i,c){var l=u[i];u[i]=function(){if(c.length==arguments.length)return c.apply(this,arguments);if(typeof l=="function")return l.apply(this,arguments)}},callCallbacks:function(u,i){i&&i.options.onceOnly&&i.firedElems.length==1&&(u=[u[0]]);for(var c=0,l;l=u[c];c++)l&&l.callback&&l.callback.call(l.elem,l.elem);i&&i.options.onceOnly&&i.firedElems.length==1&&i.me.unbindEventWithSelectorAndCallback.call(i.target,i.selector,i.callback)},checkChildNodesRecursively:function(u,i,c,l){for(var r=0,n;n=u[r];r++)c(n,i,l)&&l.push({callback:i.callback,elem:n}),n.childNodes.length>0&&m.checkChildNodesRecursively(n.childNodes,i,c,l)},mergeArrays:function(u,i){var c={},l;for(l in u)u.hasOwnProperty(l)&&(c[l]=u[l]);for(l in i)i.hasOwnProperty(l)&&(c[l]=i[l]);return c},toElementsArray:function(u){return typeof u!="undefined"&&(typeof u.length!="number"||u===p)&&(u=[u]),u}}}(),C=function(){var f=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return f.prototype.addEvent=function(u,i,c,l){var r={target:u,selector:i,options:c,callback:l,firedElems:[]};return this._beforeAdding&&this._beforeAdding(r),this._eventsBucket.push(r),r},f.prototype.removeEvent=function(u){for(var i=this._eventsBucket.length-1,c;c=this._eventsBucket[i];i--)if(u(c)){this._beforeRemoving&&this._beforeRemoving(c);var l=this._eventsBucket.splice(i,1);l&&l.length&&(l[0].callback=null)}},f.prototype.beforeAdding=function(u){this._beforeAdding=u},f.prototype.beforeRemoving=function(u){this._beforeRemoving=u},f}(),E=function(f,u){var i=new C,c=this,l={fireOnAttributesModification:!1};return i.beforeAdding(function(r){var n=r.target,a;(n===p.document||n===p)&&(n=document.getElementsByTagName("html")[0]),a=new MutationObserver(function(t){u.call(this,t,r)});var d=f(r.options);a.observe(n,d),r.observer=a,r.me=c}),i.beforeRemoving(function(r){r.observer.disconnect()}),this.bindEvent=function(r,n,a){n=m.mergeArrays(l,n);for(var d=m.toElementsArray(this),t=0;t<d.length;t++)i.addEvent(d[t],r,n,a)},this.unbindEvent=function(){var r=m.toElementsArray(this);i.removeEvent(function(n){for(var a=0;a<r.length;a++)if(this===b||n.target===r[a])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(r){var n=m.toElementsArray(this),a=r,d;typeof r=="function"?d=function(t){for(var e=0;e<n.length;e++)if((this===b||t.target===n[e])&&t.callback===a)return!0;return!1}:d=function(t){for(var e=0;e<n.length;e++)if((this===b||t.target===n[e])&&t.selector===r)return!0;return!1},i.removeEvent(d)},this.unbindEventWithSelectorAndCallback=function(r,n){var a=m.toElementsArray(this);i.removeEvent(function(d){for(var t=0;t<a.length;t++)if((this===b||d.target===a[t])&&d.selector===r&&d.callback===n)return!0;return!1})},this},k=function(){var f={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function u(r){var n={attributes:!1,childList:!0,subtree:!0};return r.fireOnAttributesModification&&(n.attributes=!0),n}function i(r,n){r.forEach(function(a){var d=a.addedNodes,t=a.target,e=[],s;d!==null&&d.length>0?m.checkChildNodesRecursively(d,n,c,e):a.type==="attributes"&&c(t,n,e)&&e.push({callback:n.callback,elem:t}),m.callCallbacks(e,n)})}function c(r,n,a){return m.matchesSelector(r,n.selector)&&(r._id===b&&(r._id=S++),n.firedElems.indexOf(r._id)==-1)?(n.firedElems.push(r._id),!0):!1}h=new E(u,i);var l=h.bindEvent;return h.bindEvent=function(r,n,a){typeof a=="undefined"?(a=n,n=f):n=m.mergeArrays(f,n);var d=m.toElementsArray(this);if(n.existing){for(var t=[],e=0;e<d.length;e++)for(var s=d[e].querySelectorAll(r),o=0;o<s.length;o++)t.push({callback:a,elem:s[o]});if(n.onceOnly&&t.length)return a.call(t[0].elem,t[0].elem);setTimeout(m.callCallbacks,1,t)}l.call(this,r,n,a)},h},R=function(){var f={};function u(){var r={childList:!0,subtree:!0};return r}function i(r,n){r.forEach(function(a){var d=a.removedNodes,t=[];d!==null&&d.length>0&&m.checkChildNodesRecursively(d,n,c,t),m.callCallbacks(t,n)})}function c(r,n){return m.matchesSelector(r,n.selector)}M=new E(u,i);var l=M.bindEvent;return M.bindEvent=function(r,n,a){typeof a=="undefined"?(a=n,n=f):n=m.mergeArrays(f,n),l.call(this,r,n,a)},M},h=new k,M=new R;function y(f,u,i){m.addMethod(u,i,f.unbindEvent),m.addMethod(u,i,f.unbindEventWithSelectorOrCallback),m.addMethod(u,i,f.unbindEventWithSelectorAndCallback)}function _(f){f.arrive=h.bindEvent,y(h,f,"unbindArrive"),f.leave=M.bindEvent,y(M,f,"unbindLeave")}g&&_(g.fn),_(HTMLElement.prototype),_(NodeList.prototype),_(HTMLCollection.prototype),_(HTMLDocument.prototype),_(Window.prototype);var v={};return y(h,v,"unbindAllArrive"),y(M,v,"unbindAllLeave"),v}(window,typeof jQuery=="undefined"?null:jQuery,void 0)}},V={};function w(A){var p=V[A];if(p!==void 0)return p.exports;var g=V[A]={exports:{}};return L[A](g,g.exports,w),g.exports}var N={};(()=>{"use strict";var A=w(640);let p=["\u4E43\u7433","\u5411\u665A","\u8D1D\u62C9","\u73C8\u4E50","\u5609\u7136"],g=[730732],b=["\u660E\u65E5\u65B9\u821F"];function S(){GM_getValue("cards")||GM_setValue("cards",p),GM_registerMenuCommand("\u6DFB\u52A0\u5361\u7247",()=>{let e=prompt(`card:
            ${GM_getValue("cards",[]).join(",")}`);if(e){let s=GM_getValue("cards");s.push(...e.split(" ")),GM_setValue("cards",s)}}),GM_registerMenuCommand("\u5220\u9664\u5361\u7247",()=>{let e=prompt(`card:
            ${GM_getValue("cards",[]).join(",")}`);if(e){let s=new Set(e.split(" "));GM_setValue("cards",GM_getValue("cards").filter(o=>!s.has(o)))}}),GM_registerMenuCommand("\u5C55\u793A\u5361\u7247",()=>{alert(`card:
            ${GM_getValue("cards",[]).join(",")}`)})}function m(t){if(t){for(const e of GM_getValue("cards",[]))if(t.includes(e))return!0}return!1}function C(){GM_getValue("matches")||GM_setValue("matches",b),GM_registerMenuCommand("\u6DFB\u52A0\u5339\u914D",()=>{let e=prompt(`matches:
            ${GM_getValue("matches",[]).join(",")}`);if(e){let s=GM_getValue("matches");s.push(...e.split(" ")),GM_setValue("matches",s)}}),GM_registerMenuCommand("\u5220\u9664\u5339\u914D",()=>{let e=prompt(`matches:
            ${GM_getValue("matches",[]).join(",")}`);if(e){let s=new Set(e.split(" "));GM_setValue("matches",GM_getValue("matches").filter(o=>!s.has(o)))}}),GM_registerMenuCommand("\u5C55\u793A\u5339\u914D",()=>{alert(`matches:
            ${GM_getValue("matches",[]).join(",")}`)})}function E(t){if(t){for(const e of GM_getValue("matches",[]))if(t.includes(e))return!0}return!1}function k(){GM_getValue("uids")||GM_setValue("uids",g),GM_registerMenuCommand("\u6DFB\u52A0up",()=>{let e=GM_getValue("uids",[]).map(o=>`${o}(${h(o)})`).join(","),s=prompt(`uid:
            ${e}`);if(s){let o=GM_getValue("uids");o.push(...s.split(" ").map(Number)),GM_setValue("uids",o)}}),GM_registerMenuCommand("\u5220\u9664up",()=>{let e=GM_getValue("uids",[]).map(o=>`${o}(${h(o)})`).join(","),s=prompt(`uid:
            ${e}`);if(s){let o=new Set(s.split(" ").map(Number));GM_setValue("uids",GM_getValue("uids").filter(G=>!o.has(G)))}}),GM_registerMenuCommand("\u5C55\u793Aup",()=>{let e=GM_getValue("uids",[]).map(s=>`${s}(${h(s)})`).join(",");alert(`uid:
            ${e}`)})}class R{constructor(e,s,o){this.uid=e,this.username=s,this.expiretime=o}}function h(t){let s=GM_getValue("uid_"+t);if(s&&new Date().getTime()<s.expiretime)return s.username;{let o=new XMLHttpRequest;o.open("GET","https://api.bilibili.com/x/space/acc/info?mid="+t,!1),o.send(null);let G=JSON.parse(o.responseText).data.name;return s={uid:t,username:G,expiretime:new Date().getTime()+Math.random()*24*60*60*1e3},GM_setValue("uid_"+t,s),s.username}}function M(t){return t?GM_getValue("uids",[]).includes(t):!1}function y(t){return t?GM_getValue("uids",[]).map(h).includes(t):!1}function _(t){if(t){for(const e of GM_getValue("uids",[]).map(h))if(t.includes(e))return!0}return!1}class v{bingo(e){return!1}ifRemove(e){if(this.innerSelector===void 0){if(this.bingo(e))return!0}else{let s=e.querySelectorAll(this.innerSelector);for(let o=0;o<s.length;o++){const G=s[o];if(this.bingo(G))return!0}}return!1}}class f extends v{constructor(){super(...arguments),this.mainSelector=".rank-wrap",this.innerSelector=".info .name"}bingo(e){return y(e.innerHTML)}}class u extends v{constructor(){super(...arguments),this.mainSelector=".video-card-reco",this.innerSelector="img"}bingo(e){return E(e.getAttribute("alt"))}}class i extends v{constructor(){super(...arguments),this.mainSelector=".van-slide .item",this.innerSelector="img"}bingo(e){return E(e.getAttribute("alt"))}}class c extends v{constructor(){super(...arguments),this.mainSelector=".video-card-common",this.innerSelector="a.title"}bingo(e){return E(e.getAttribute("title"))}}class l extends v{constructor(){super(...arguments),this.mainSelector=".video-card-common",this.innerSelector="a.up"}bingo(e){return _(e.innerHTML)}}class r extends v{constructor(){super(...arguments),this.mainSelector=".list-item",this.innerSelector=".sailing-img"}bingo(e){return m(e.getAttribute("alt"))}}class n extends v{constructor(){super(...arguments),this.mainSelector=".list-item",this.innerSelector="p.text img"}bingo(e){return m(e.getAttribute("alt"))}}class a extends v{constructor(){super(...arguments),this.mainSelector=".reply-item",this.innerSelector="img"}bingo(e){return m(e.getAttribute("alt"))}}d();function d(){S(),k(),C();for(const t of[new f,new r,new n,new a,new u,new i,new c,new l])document.arrive(t.mainSelector,{fireOnAttributesModification:!0,onceOnly:!1,existing:!0},e=>{t.ifRemove(e)&&e.remove()})}})()})();
