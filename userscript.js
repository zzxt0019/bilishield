// ==UserScript==
// @name        bilibili屏蔽
// @version     1.0
// @author      zzxt0019
// @match       *://www.bilibili.com/*
// @match       *://search.bilibili.com/*
// @match       *://live.bilibili.com/*
// @match       *://space.bilibili.com/*
// @match       *://t.bilibili.com/*
// @match       *://h.bilibili.com/*
// @match       *://manga.bilibili.com/*
// @match       *://message.bilibili.com/*
// @noframes
// @description bilibili屏蔽
// @grant       GM_setValue
// @grant       GM_getValue
// @grant       GM_deleteValue
// @grant       GM_registerMenuCommand
// ==/UserScript==
(()=>{var S={640:()=>{var y=function(h,p,_){"use strict";if(!h.MutationObserver||typeof HTMLElement=="undefined")return;var A=0,f=function(){var o=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(s,l){return s instanceof HTMLElement&&o.call(s,l)},addMethod:function(s,l,c){var u=s[l];s[l]=function(){if(c.length==arguments.length)return c.apply(this,arguments);if(typeof u=="function")return u.apply(this,arguments)}},callCallbacks:function(s,l){l&&l.options.onceOnly&&l.firedElems.length==1&&(s=[s[0]]);for(var c=0,u;u=s[c];c++)u&&u.callback&&u.callback.call(u.elem,u.elem);l&&l.options.onceOnly&&l.firedElems.length==1&&l.me.unbindEventWithSelectorAndCallback.call(l.target,l.selector,l.callback)},checkChildNodesRecursively:function(s,l,c,u){for(var i=0,n;n=s[i];i++)c(n,l,u)&&u.push({callback:l.callback,elem:n}),n.childNodes.length>0&&f.checkChildNodesRecursively(n.childNodes,l,c,u)},mergeArrays:function(s,l){var c={},u;for(u in s)s.hasOwnProperty(u)&&(c[u]=s[u]);for(u in l)l.hasOwnProperty(u)&&(c[u]=l[u]);return c},toElementsArray:function(s){return typeof s!="undefined"&&(typeof s.length!="number"||s===h)&&(s=[s]),s}}}(),G=function(){var o=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return o.prototype.addEvent=function(s,l,c,u){var i={target:s,selector:l,options:c,callback:u,firedElems:[]};return this._beforeAdding&&this._beforeAdding(i),this._eventsBucket.push(i),i},o.prototype.removeEvent=function(s){for(var l=this._eventsBucket.length-1,c;c=this._eventsBucket[l];l--)if(s(c)){this._beforeRemoving&&this._beforeRemoving(c);var u=this._eventsBucket.splice(l,1);u&&u.length&&(u[0].callback=null)}},o.prototype.beforeAdding=function(s){this._beforeAdding=s},o.prototype.beforeRemoving=function(s){this._beforeRemoving=s},o}(),C=function(o,s){var l=new G,c=this,u={fireOnAttributesModification:!1};return l.beforeAdding(function(i){var n=i.target,e;(n===h.document||n===h)&&(n=document.getElementsByTagName("html")[0]),e=new MutationObserver(function(t){s.call(this,t,i)});var r=o(i.options);e.observe(n,r),i.observer=e,i.me=c}),l.beforeRemoving(function(i){i.observer.disconnect()}),this.bindEvent=function(i,n,e){n=f.mergeArrays(u,n);for(var r=f.toElementsArray(this),t=0;t<r.length;t++)l.addEvent(r[t],i,n,e)},this.unbindEvent=function(){var i=f.toElementsArray(this);l.removeEvent(function(n){for(var e=0;e<i.length;e++)if(this===_||n.target===i[e])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(i){var n=f.toElementsArray(this),e=i,r;typeof i=="function"?r=function(t){for(var a=0;a<n.length;a++)if((this===_||t.target===n[a])&&t.callback===e)return!0;return!1}:r=function(t){for(var a=0;a<n.length;a++)if((this===_||t.target===n[a])&&t.selector===i)return!0;return!1},l.removeEvent(r)},this.unbindEventWithSelectorAndCallback=function(i,n){var e=f.toElementsArray(this);l.removeEvent(function(r){for(var t=0;t<e.length;t++)if((this===_||r.target===e[t])&&r.selector===i&&r.callback===n)return!0;return!1})},this},M=function(){var o={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function s(i){var n={attributes:!1,childList:!0,subtree:!0};return i.fireOnAttributesModification&&(n.attributes=!0),n}function l(i,n){i.forEach(function(e){var r=e.addedNodes,t=e.target,a=[],d;r!==null&&r.length>0?f.checkChildNodesRecursively(r,n,c,a):e.type==="attributes"&&c(t,n,a)&&a.push({callback:n.callback,elem:t}),f.callCallbacks(a,n)})}function c(i,n,e){return f.matchesSelector(i,n.selector)&&(i._id===_&&(i._id=A++),n.firedElems.indexOf(i._id)==-1)?(n.firedElems.push(i._id),!0):!1}m=new C(s,l);var u=m.bindEvent;return m.bindEvent=function(i,n,e){typeof e=="undefined"?(e=n,n=o):n=f.mergeArrays(o,n);var r=f.toElementsArray(this);if(n.existing){for(var t=[],a=0;a<r.length;a++)for(var d=r[a].querySelectorAll(i),k=0;k<d.length;k++)t.push({callback:e,elem:d[k]});if(n.onceOnly&&t.length)return e.call(t[0].elem,t[0].elem);setTimeout(f.callCallbacks,1,t)}u.call(this,i,n,e)},m},L=function(){var o={};function s(){var i={childList:!0,subtree:!0};return i}function l(i,n){i.forEach(function(e){var r=e.removedNodes,t=[];r!==null&&r.length>0&&f.checkChildNodesRecursively(r,n,c,t),f.callCallbacks(t,n)})}function c(i,n){return f.matchesSelector(i,n.selector)}v=new C(s,l);var u=v.bindEvent;return v.bindEvent=function(i,n,e){typeof e=="undefined"?(e=n,n=o):n=f.mergeArrays(o,n),u.call(this,i,n,e)},v},m=new M,v=new L;function E(o,s,l){f.addMethod(s,l,o.unbindEvent),f.addMethod(s,l,o.unbindEventWithSelectorOrCallback),f.addMethod(s,l,o.unbindEventWithSelectorAndCallback)}function g(o){o.arrive=m.bindEvent,E(m,o,"unbindArrive"),o.leave=v.bindEvent,E(v,o,"unbindLeave")}p&&g(p.fn),g(HTMLElement.prototype),g(NodeList.prototype),g(HTMLCollection.prototype),g(HTMLDocument.prototype),g(Window.prototype);var b={};return E(m,b,"unbindAllArrive"),E(v,b,"unbindAllLeave"),b}(window,typeof jQuery=="undefined"?null:jQuery,void 0)}},V={};function w(y){var h=V[y];if(h!==void 0)return h.exports;var p=V[y]={exports:{}};return S[y](p,p.exports,w),p.exports}var B={};(()=>{"use strict";var y=w(640);let h=["\u4E43\u7433","\u5411\u665A","\u8D1D\u62C9","\u73C8\u4E50","\u5609\u7136"],p=[730732],_=["\u660E\u65E5\u65B9\u821F"];function A(){GM_getValue("matches")||GM_setValue("matches",_),GM_registerMenuCommand("\u6DFB\u52A0\u5339\u914D",()=>{let r=prompt(`matches:
            ${GM_getValue("matches",[]).join(",")}`);if(r){let t=GM_getValue("matches");t.push(...r.split(" ")),GM_setValue("matches",t)}}),GM_registerMenuCommand("\u5220\u9664\u5339\u914D",()=>{let r=prompt(`matches:
            ${GM_getValue("matches",[]).join(",")}`);if(r){let t=new Set(r.split(" "));GM_setValue("matches",GM_getValue("matches").filter(a=>!t.has(a)))}}),GM_registerMenuCommand("\u5C55\u793A\u5339\u914D",()=>{alert(`matches:
            ${GM_getValue("matches",[]).join(",")}`)})}function f(e){if(e){for(const r of GM_getValue("matches",[]))if(e.includes(r))return!0}return!1}function G(){GM_getValue("uids")||GM_setValue("uids",p),GM_registerMenuCommand("\u6DFB\u52A0up",()=>{let r=GM_getValue("uids",[]).map(a=>`${a}(${M(a)})`).join(","),t=prompt(`uid:
            ${r}`);if(t){let a=t.split(" ").map(Number),d=GM_getValue("uids");d.push(...a),GM_setValue("uids",d);for(const k of a)setTimeout(M(k))}}),GM_registerMenuCommand("\u5220\u9664up",()=>{let r=GM_getValue("uids",[]).map(a=>`${a}(${M(a)})`).join(","),t=prompt(`uid:
            ${r}`);if(t){let a=new Set(t.split(" ").map(Number));GM_setValue("uids",GM_getValue("uids").filter(d=>!a.has(d)));for(const d of a)GM_deleteValue("uid_"+d)}}),GM_registerMenuCommand("\u5C55\u793Aup",()=>{let r=GM_getValue("uids",[]).map(t=>`${t}(${M(t)})`).join(",");alert(`uid:
            ${r}`)})}class C{constructor(r,t,a){this.uid=r,this.username=t,this.expiretime=a}}function M(e){let t=GM_getValue("uid_"+e);if(t&&new Date().getTime()<t.expiretime)return t.username;{let a=new XMLHttpRequest;a.open("GET","https://api.bilibili.com/x/space/acc/info?mid="+e,!1),a.send(null);let d=JSON.parse(a.responseText).data.name;return t={uid:e,username:d,expiretime:new Date().getTime()+Math.random()*24*60*60*1e3},GM_setValue("uid_"+e,t),t.username}}function L(e){return e?GM_getValue("uids",[]).includes(e):!1}function m(e){return e?GM_getValue("uids",[]).map(M).includes(e):!1}function v(e){if(e){for(const r of GM_getValue("uids",[]).map(M))if(e.includes(r))return!0}return!1}function E(){u(".result.c-container","a",e=>e.innerHTML.includes("\u516C\u53F8\u6765\u4E86\u4E2A\u65B0\u540C\u4E8B")),u(".rank-wrap",".info .name",e=>m(e.innerHTML)),u(".video-card-reco","img",e=>f(e.getAttribute("alt"))),u(".van-slide .item","img",e=>f(e.getAttribute("alt"))),u(".van-slide .item","i.bypb-icon",()=>!0),u(".video-card-common","a.title",e=>f(e.getAttribute("title"))),u(".video-card-common","a.up",e=>v(e.innerHTML)),u(".video-card-common",".gg-normal-icon",()=>!0),u("a.banner-card.b-wrap",".gg-icon",()=>!0)}function g(){GM_getValue("cards")||GM_setValue("cards",h),GM_registerMenuCommand("\u6DFB\u52A0\u5361\u7247",()=>{let r=prompt(`card:
            ${GM_getValue("cards",[]).join(",")}`);if(r){let t=GM_getValue("cards");t.push(...r.split(" ")),GM_setValue("cards",t)}}),GM_registerMenuCommand("\u5220\u9664\u5361\u7247",()=>{let r=prompt(`card:
            ${GM_getValue("cards",[]).join(",")}`);if(r){let t=new Set(r.split(" "));GM_setValue("cards",GM_getValue("cards").filter(a=>!t.has(a)))}}),GM_registerMenuCommand("\u5C55\u793A\u5361\u7247",()=>{alert(`card:
            ${GM_getValue("cards",[]).join(",")}`)})}function b(e){if(e){for(const r of GM_getValue("cards",[]))if(e.includes(r))return!0}return!1}function o(){u(".list-item",".sailing-img",e=>b(e.getAttribute("alt"))),u(".list-item","p.text img",e=>b(e.getAttribute("alt"))),u(".reply-item","img",e=>b(e.getAttribute("alt")))}class s{constructor(r,t){this.innerSelector=r,this.bingo=t}check(r){if(this.innerSelector){let t=r.querySelectorAll(this.innerSelector);for(let a=0;a<t.length;a++){const d=t[a];if(this.bingo(d))return!0}}return!1}}class l{constructor(r,t){this.mainSelector=r,this.checkers=t}ifRemove(r){for(const t of this.checkers)if(t.check(r))return!0;return!1}}let c=new Map;function u(e,r,t){let a=c.get(e),d=a||[];d.push(new s(r,t)),a||c.set(e,d)}function i(){E(),o();let e=[];return c.forEach((r,t)=>{e.push(new l(t,r))}),e}n();function n(){g(),G(),A();for(const e of i())document.arrive(e.mainSelector,{fireOnAttributesModification:!0,onceOnly:!1,existing:!0},r=>{e.ifRemove(r)&&r.remove()})}})()})();
